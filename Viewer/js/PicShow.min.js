;
(function($, document, window, undefined) {
    var PicShow = function(options) { this.default = { 'singlePicWidth': 100, 'picTop': -200, 'fadeIntime': 100, };
        this.settings = $.extend({}, this.default, options);
        this.renderDom();
        var ele, $that = this;
        $('.imgList').on('click', 'img', function() { ele = $(this);
            $that.$currentThis = $(this);
            $that.imgId = ele.data('id');
            $that.init() }) this.imgList = $('.imgList');
        this.mask = $('.mask');
        this.popup = $('.popup');
        this.nowPic = $('.current-pic img');
        this.picList = $('.pic-list');
        this.prev = $('#prev');
        this.next = $('#next');
        this.closeBtn = $('#close') };
    PicShow.prototype = { init: function() { this.popupShow();
            this.allEvent();
            this.currentPic() }, baseCss: function() {}, popupShow: function() {
            var $that = this;
            this.mask.fadeIn(this.settings.fadeIntime, function() { $that.nowPic.css({ top: $that.settings.picTop, opacity: 0 }).animate({ 'top': 0, 'opacity': 1 }, 'slow') });
            this.popup.fadeIn(1000) }, popupHide: function() { this.popup.fadeOut('fast');
            this.mask.fadeOut('slow') }, picChange: function(currentLeft, picWidth) { $that = this;
            if ($that.picList.is(':animated')) {
                return }
            $that.picList.animate({ 'left': currentLeft + picWidth }, function() {
                var dataId = 0;
                if (picWidth > 0) { dataId = $that.nowPic.data('id') - 1 } else { dataId = $that.nowPic.data('id') + 1 }
                var activePic = $that.picList.find('img[data-id=' + dataId + ']');
                activePic.addClass('active').siblings().removeClass('active');
                $that.nowPic.data('id', dataId);
                $that.nowPic.attr('src', activePic.attr('src')).hide().fadeIn('slow') }) }, allEvent: function() {
            var $that = this,
                imglength = $that.picList.find('img').length * $that.settings.singlePicWidth;
            this.closeBtn.on('click', function() { $that.popupHide() });
            this.next.on('click', function() {
                var currentLeft = parseInt($that.picList.css('left'));
                if (Math.abs(currentLeft) < (imglength - $that.settings.singlePicWidth)) { $that.picChange(currentLeft, -$that.settings.singlePicWidth) } else {
                    return } });
            this.prev.on('click', function() {
                var currentLeft = parseInt($that.picList.css('left'));
                if (Math.abs(currentLeft) > 0) { console.log('prev');
                    $that.picChange(currentLeft, $that.settings.singlePicWidth) } else {
                    return } });
            this.picList.on('click', 'img', function() { $(this).addClass('active').siblings().removeClass('active');
                $that.picList.css({ 'left': -parseInt($(this).data('id')) * $that.settings.singlePicWidth });
                $that.nowPic.attr('src', $(this).attr('src')).hide().fadeIn();
                $that.nowPic.data('id', $(this).data('id')) }) }, currentPic: function() {
            var currentSrc = this.$currentThis.attr('src'),
                dataId = this.$currentThis.data('id');
            this.nowPic.data('id', dataId);
            this.nowPic.attr('src', currentSrc);
            var activePic = this.picList.find('img[data-id=' + dataId + ']');
            activePic.addClass('active').siblings().removeClass('active');
            this.picList.css({ 'left': -parseInt(dataId) * this.settings.singlePicWidth }) }, renderDom: function() {
            var $that = this,
                html = '';
            var picSrc = ['images/1.jpg', 'images/2.jpg', 'images/3.jpg', 'images/4.jpg', 'images/5.jpg', 'images/1-6.jpg', 'images/1-7.jpg', 'images/1-8.jpg', ];
            var html = '<div class="mask"></div>' + '<div class="popup">' + '<div class="current-pic"><img src="' + picSrc[0] + '"></div>' + '<div class="pic-container">' + '<div class="pic-list">';
            $.each(picSrc, function(index, val) { html += '<img src="' + val + '" alt="1" data-id="' + index + '" />' });
            html += '</div></div>' + '<span id="prev" class="arrow">&lt;</span>' + '<span id="next" class="arrow">&gt;</span>' + '<span id="close" class="close-btn"></span>' + '</div>';
            $('body').append(html) } };
    $.fn.picShow = function() {
        return new PicShow() } })(jQuery, document, window);
